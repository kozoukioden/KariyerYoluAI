---
title: "Sequence DiyagramÄ± 3: AI Mentor Chatbot AkÄ±ÅŸÄ±"
---
sequenceDiagram
    actor User as KullanÄ±cÄ±
    participant Chat as ChatWidget
    participant API as ChatAPI<br/>(/api/chat)
    participant DB as tracks.json<br/>(RAG Bilgi TabanÄ±)
    participant Groq as Groq API<br/>(Llama 3.3 70B)

    Note over User,Groq: Chat BaÅŸlatma

    User->>Chat: Chat ikonuna tÄ±kla
    Chat->>Chat: isOpen = true
    Chat->>User: Chat penceresi aÃ§<br/>HoÅŸgeldin mesajÄ±<br/>HÄ±zlÄ± soru butonlarÄ±

    Note over User,Groq: Mesaj GÃ¶nderme + RAG

    User->>Chat: "React hooks nedir?" yaz
    Chat->>Chat: messages.push({role: user})<br/>isLoading = true
    Chat->>User: YÃ¼kleniyor animasyonu

    Chat->>API: POST /api/chat<br/>{message, history[], current_track_id}
    activate API

    API->>DB: tracks.json oku (15 track, 200+ ders)
    DB-->>API: TÃ¼m ders iÃ§erikleri

    API->>API: RAG Arama:<br/>1. Soruyu analiz et<br/>2. Ders iÃ§eriklerinde ara<br/>3. current_track'e Ã¶ncelik ver<br/>4. Ä°lgili context bul

    Note over API: context = [{title: "React Hooks"},<br/>{title: "State YÃ¶netimi"}]

    API->>Groq: POST /openai/v1/chat/completions<br/>{model: "llama-3.3-70b-versatile",<br/>system: "KariyerYolu AI mentor...<br/>RAG context: [ders iÃ§erikleri]",<br/>messages: [...history, user_message],<br/>temperature: 0.7}
    activate Groq

    Groq->>Groq: LLM Ä°ÅŸleme<br/>Context + Soru â†’ Cevap
    Groq-->>API: AI cevabÄ± (markdown formatÄ±nda)
    deactivate Groq

    API-->>Chat: {reply: "React Hooks...",<br/>source: "rag",<br/>context: [{title, trackId}]}
    deactivate API

    Chat->>Chat: isLoading = false<br/>messages.push({role: assistant})
    Chat->>User: CevabÄ± gÃ¶ster (markdown)<br/>Kaynak: "ğŸ“š RAG"

    Note over User,Groq: Hata DurumlarÄ±

    alt Groq API HatasÄ±
        API-->>Chat: {source: "fallback"}
        Chat->>User: Fallback mesaj gÃ¶ster
    else RAG sonuÃ§ bulunamadÄ±
        API->>Groq: Context olmadan genel soru
        Groq-->>API: Genel AI cevabÄ±
        API-->>Chat: {source: "ai"}
        Chat->>User: AI cevabÄ± gÃ¶ster
    end
